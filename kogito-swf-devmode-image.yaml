  - name: builder
    from: "registry.access.redhat.com/ubi8/ubi-minimal:latest"
    version: "999-SNAPSHOT"
    modules:
      repositories:
        - path: modules
      install:
        - name: org.kie.kogito.image.dependencies
        - name: org.kie.kogito.system.user
        - name: org.kie.kogito.logging
        - name: org.kie.kogito.launch.scripts
        - name: org.kie.kogito.openjdk
          version: "17"
        - name: org.kie.kogito.dynamic.resources
        - name: org.kie.kogito.maven
          version: "3.9.3"
        - name: org.kie.kogito.maven.common
        - name: org.kie.kogito.project.versions
        - name: org.kie.kogito.swf.common.scripts
        - name: org.kie.kogito.swf.devmode.build-config
        - name: org.kie.kogito.swf.common.build

    packages:
      manager: microdnf

  - name: "quay.io/kiegroup/kogito-swf-devmode"
    from: "registry.access.redhat.com/ubi8/ubi-minimal:latest"
    version: "999-SNAPSHOT"
    description: "Kogito Serverless Workflow development mode with Quarkus extensions libraries preinstalled"

    labels:
      - name: "io.quarkus.platform.version"
        value: "3.2.9.Final"
      - name: "org.kie.kogito.version"
        value: "999-SNAPSHOT"
      - name: "maintainer"
        value: "Apache KIE <dev@kie.apache.org>"
      - name: "io.k8s.description"
        value: "Kogito Serverless Workflow base builder with Quarkus extensions libraries preinstalled."
      - name: "io.k8s.display-name"
        value: "Kogito SWF Builder"
      - name: "io.openshift.tags"
        value: "kogito,development,serverless,workflow"
      - name: "io.openshift.expose-services"
        value: "8080:http,5005:http"

    packages:
      manager: microdnf

    modules:
      repositories:
        - path: modules
      install:
        - name: org.kie.kogito.image.dependencies
        - name: org.kie.kogito.system.user
        - name: org.kie.kogito.logging
        - name: org.kie.kogito.launch.scripts
        - name: org.kie.kogito.openjdk
          version: "17"
        - name: org.kie.kogito.dynamic.resources
        - name: org.kie.kogito.maven
          version: "3.9.3"
        - name: org.kie.kogito.maven.common
        - name: org.kie.kogito.project.versions
        - name: org.kie.kogito.swf.common.scripts
        - name: org.kie.kogito.swf.devmode.runtime.common
        - name: org.kie.kogito.swf.devmode.runtime.community

    ports:
      - value: 8080
      - value: 5005

    run:
      workdir: "/home/kogito/${PROJECT_ARTIFACT_ID}"
      user: 1001
      cmd:
        - "/home/kogito/launch/run-app-devmode.sh"
